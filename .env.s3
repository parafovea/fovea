# S3-Based Production Deployment Environment Configuration
# For production deployments with S3 video storage
# Copy this file to .env and update values for your production deployment

# Database Configuration
POSTGRES_USER=fovea
POSTGRES_PASSWORD=CHANGE_ME_SECURE_PASSWORD
POSTGRES_DB=fovea
DATABASE_URL=postgresql://fovea:CHANGE_ME_SECURE_PASSWORD@postgres:5432/fovea

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379

# Backend Configuration
NODE_ENV=production
MODEL_SERVICE_URL=http://model-service:8000
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
SESSION_SECRET=CHANGE_ME_LONG_RANDOM_STRING

# Frontend Configuration (build-time variables)
VITE_API_URL=https://your-domain.com/api
VITE_MODEL_SERVICE_URL=https://your-domain.com/model-api

# Model Service Configuration
TRANSFORMERS_CACHE=/models
MODEL_CONFIG_PATH=/config/models.yaml
# GPU configuration (adjust based on available GPUs)
CUDA_VISIBLE_DEVICES=0,1,2,3
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512

# Grafana Configuration
GF_SECURITY_ADMIN_PASSWORD=CHANGE_ME_SECURE_PASSWORD
GF_USERS_ALLOW_SIGN_UP=false

# Video Storage Configuration - S3 STORAGE
VIDEO_STORAGE_TYPE=s3
STORAGE_PATH=/videos  # Used for temporary downloads only
VIDEO_BASE_URL=/api/videos

# S3 Configuration - REQUIRED for S3 storage
S3_BUCKET=your-fovea-videos-bucket
S3_REGION=us-east-1
# Provide credentials OR use IAM role (leave blank to use IAM role)
S3_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
S3_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
# Optional: For S3-compatible services (MinIO, DigitalOcean Spaces, etc.)
# S3_ENDPOINT=https://nyc3.digitaloceanspaces.com
# Set to true only if bucket allows public reads (not recommended for production)
S3_PUBLIC_BUCKET=false

# CDN Configuration - RECOMMENDED for production
# Use CloudFront or another CDN for better video delivery
CDN_ENABLED=true
CDN_BASE_URL=https://d1234567890abc.cloudfront.net
# Use signed URLs for security (requires CloudFront configuration)
CDN_SIGNED_URLS=true

# Thumbnail Storage Configuration
# Thumbnails can be stored separately from videos
# Option 1: Store thumbnails in S3 with videos
THUMBNAIL_STORAGE_TYPE=s3
THUMBNAIL_S3_PREFIX=thumbnails/
# Option 2: Store thumbnails locally for faster access
# THUMBNAIL_STORAGE_TYPE=local
THUMBNAIL_PATH=/videos/thumbnails

# Port Configuration (host ports)
FRONTEND_PORT=3000
BACKEND_PORT=3001
MODEL_SERVICE_PORT=8000
POSTGRES_PORT=5432
REDIS_PORT=6379
PROMETHEUS_PORT=9090
GRAFANA_PORT=3002
OTEL_GRPC_PORT=4317
OTEL_HTTP_PORT=4318

# Build Mode
# Use 'full' for GPU deployments with all model support
MODEL_BUILD_MODE=full
