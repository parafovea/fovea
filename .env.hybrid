# Hybrid Storage Deployment Environment Configuration
# For deployments that need both local and S3 storage with automatic failover
# Use case: Transitioning from local to S3, or maintaining local cache with S3 backup
# Copy this file to .env and update values for your deployment

# Database Configuration
POSTGRES_USER=fovea
POSTGRES_PASSWORD=CHANGE_ME_SECURE_PASSWORD
POSTGRES_DB=fovea
DATABASE_URL=postgresql://fovea:CHANGE_ME_SECURE_PASSWORD@postgres:5432/fovea

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379

# Backend Configuration
NODE_ENV=production
MODEL_SERVICE_URL=http://model-service:8000
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
SESSION_SECRET=CHANGE_ME_LONG_RANDOM_STRING

# Frontend Configuration (build-time variables)
VITE_API_URL=https://your-domain.com/api
VITE_MODEL_SERVICE_URL=https://your-domain.com/model-api

# Model Service Configuration
TRANSFORMERS_CACHE=/models
MODEL_CONFIG_PATH=/config/models.yaml
CUDA_VISIBLE_DEVICES=0
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512

# Grafana Configuration
GF_SECURITY_ADMIN_PASSWORD=CHANGE_ME_SECURE_PASSWORD
GF_USERS_ALLOW_SIGN_UP=false

# Video Storage Configuration - HYBRID STORAGE
# Hybrid mode tries S3 first, falls back to local storage
# Useful for:
# - Gradual migration from local to S3
# - Local caching with S3 backup
# - Fault tolerance (S3 outage protection)
VIDEO_STORAGE_TYPE=hybrid
STORAGE_PATH=/videos
VIDEO_BASE_URL=/api/videos

# S3 Configuration - REQUIRED for hybrid storage
S3_BUCKET=your-fovea-videos-bucket
S3_REGION=us-east-1
# Provide credentials OR use IAM role (leave blank to use IAM role)
S3_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
S3_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
# Optional: For S3-compatible services
# S3_ENDPOINT=https://nyc3.digitaloceanspaces.com
S3_PUBLIC_BUCKET=false

# CDN Configuration - Optional but recommended
CDN_ENABLED=false
# CDN_BASE_URL=https://d1234567890abc.cloudfront.net
# CDN_SIGNED_URLS=true

# Thumbnail Storage Configuration
# In hybrid mode, you can choose where thumbnails are stored
# Option 1: Store thumbnails locally (faster, recommended)
THUMBNAIL_STORAGE_TYPE=local
THUMBNAIL_PATH=/videos/thumbnails
# Option 2: Store thumbnails in S3
# THUMBNAIL_STORAGE_TYPE=s3
# THUMBNAIL_S3_PREFIX=thumbnails/

# Port Configuration (host ports)
FRONTEND_PORT=3000
BACKEND_PORT=3001
MODEL_SERVICE_PORT=8000
POSTGRES_PORT=5432
REDIS_PORT=6379
PROMETHEUS_PORT=9090
GRAFANA_PORT=3002
OTEL_GRPC_PORT=4317
OTEL_HTTP_PORT=4318

# Build Mode
MODEL_BUILD_MODE=full
