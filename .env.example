# Environment configuration for fovea Docker Compose deployment
# Copy this file to .env and update values as needed

# Database Configuration
POSTGRES_USER=fovea
POSTGRES_PASSWORD=fovea_password
POSTGRES_DB=fovea
DATABASE_URL=postgresql://fovea:fovea_password@postgres:5432/fovea

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379

# Backend Configuration
NODE_ENV=production
PORT=3001
MODEL_SERVICE_URL=http://model-service:8000
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000
LOG_LEVEL=info

# Authentication Configuration
# Set FOVEA_MODE=multi-user for production deployments with login/sessions
# Set FOVEA_MODE=single-user for local development (auto-login, no passwords)
FOVEA_MODE=multi-user
ALLOW_REGISTRATION=false
SESSION_SECRET=your-secret-key-here-min-32-chars-use-openssl-rand-base64-32
SESSION_TIMEOUT_DAYS=7

# Admin User Configuration (REQUIRED for multi-user mode)
# This password is used when seeding the database to create the admin account
# Generate with: openssl rand -base64 32
ADMIN_PASSWORD=<set-strong-password-here>

# Optional: Test user password (defaults to 'test123' if not set)
TEST_USER_PASSWORD=<optional-test-password>

# API Key Encryption (REQUIRED for API key management feature)
# Generate with: openssl rand -hex 64
API_KEY_ENCRYPTION_KEY=your-32-byte-hex-key-here

# Frontend Configuration
VITE_API_URL=http://backend:3001
VITE_MODEL_SERVICE_URL=http://model-service:8000

# Model Service Configuration
TRANSFORMERS_CACHE=/models
MODEL_CONFIG_PATH=/config/models.yaml
CUDA_VISIBLE_DEVICES=0,1,2,3  # Adjust based on available GPUs
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512

# Grafana Configuration
GF_SECURITY_ADMIN_PASSWORD=admin
GF_USERS_ALLOW_SIGN_UP=false

# Video Storage Configuration
# Choose storage backend: local, s3, or hybrid
VIDEO_STORAGE_TYPE=local
STORAGE_PATH=/videos
VIDEO_BASE_URL=/api/videos

# S3 Configuration (when VIDEO_STORAGE_TYPE=s3 or hybrid)
# Uncomment and configure when using S3 storage
# S3_BUCKET=fovea-demo-videos
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=your-access-key-id
# S3_SECRET_ACCESS_KEY=your-secret-access-key
# S3_ENDPOINT=                          # Optional: for S3-compatible services (MinIO, DigitalOcean Spaces, etc.)
# S3_PUBLIC_BUCKET=false                # Set to true if bucket allows public reads (not recommended)

# CDN Configuration (optional)
# Enable CDN for improved video delivery performance
# CDN_ENABLED=false
# CDN_BASE_URL=https://cdn.fovea.video
# CDN_SIGNED_URLS=true                  # Use signed URLs for CDN access

# Thumbnail Storage (can differ from video storage)
# Thumbnails can be stored separately from videos for better performance
THUMBNAIL_STORAGE_TYPE=local
THUMBNAIL_PATH=/videos/thumbnails
# THUMBNAIL_S3_PREFIX=thumbnails/       # S3 key prefix when using S3 storage

# Wikidata/Wikibase Configuration
# Use WIKIDATA_MODE=online for public Wikidata, WIKIDATA_MODE=offline for local Wikibase
WIKIDATA_MODE=online
# WIKIDATA_URL=https://www.wikidata.org/w/api.php  # Default for online mode
# WIKIDATA_URL=http://wikibase:8181/w/api.php      # Use for offline mode with local Wikibase

# Wikibase ID Mapping (offline mode only)
# Path to JSON file mapping original Wikidata IDs to local Wikibase IDs
# WIKIBASE_ID_MAPPING_PATH=/wikibase/id-mapping.json

# External Link Controls
# Master switch for all external links (Wikidata entity pages, video sources)
# ALLOW_EXTERNAL_LINKS=true

# Specific controls (override master switch when set)
# ALLOW_EXTERNAL_WIKIDATA_LINKS=true    # Controls Wikidata entity page links
# ALLOW_EXTERNAL_VIDEO_SOURCE_LINKS=true # Controls video source links (uploaderUrl, webpageUrl)

# Port Configuration (host ports)
FRONTEND_PORT=3000
BACKEND_PORT=3001
MODEL_SERVICE_PORT=8000
POSTGRES_PORT=5432
REDIS_PORT=6379
PROMETHEUS_PORT=9090
GRAFANA_PORT=3002
OTEL_GRPC_PORT=4317
OTEL_HTTP_PORT=4318
